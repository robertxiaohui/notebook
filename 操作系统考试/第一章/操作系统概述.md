

裸机：纯硬件

裸机安装了操作系统：虚拟机



操作系统本质是一个软件，连接硬件和其他软件，给用户提供更方便的服务，我们直接操作硬件时，硬件只能识别二进制指令，操作系统将作为媒介，我们可以向操作系统提供的接口发出简单的请求，操作系统将我们的请求翻译成硬件能识别的二进制指令





## 操作系统的目标和功能

### 1.目标(目标就是我们设计操作系统这个软件需要帮助我们解决什么样的问题(完成什么样的需求)，解决单道程序运行cpu效率不高，实现多道程序并发运行)



```
操作系统这个软件的诞生是为了实现多道程序并发执行，因为在单道程序执行的时候，如果单道程序调用了I/O设备，那么就需要等待I/O设备，此时cpu就会等待，为了提高cpu的利用率，操作系统这个软件就诞生了，我们通过这个软件配合时钟信号实现了多道程序并发执行

并且在操作系统的发展中，为了实现多道程序并发执行，操作系统需要成为系统资源的管理者(软硬件资源)，当应用程序需要使用系统资源时，向操作系统软件发出请求，由操作系统进行分配

在后续发展中，人们又希望在程序运行时可以进行人机交互，操作系统来解决这个需求，操作系统要向用户提供一些接口，让用户可以和机器进行交互


```



所以，操作系统的目标就是

1.充当系统资源的管理者

2.提供人机交互的接口

3.根据上面两点总结就是，操作系统扩展了硬件机器，让人们可以更简单的使用机器





### 2.功能(为了实现目标需要具备的功能)

1.进程管理(处理机管理)

2.内存管理(存储器管理)

3.文件管理

4.设备管理







## 操作系统提供给我们的接口：

### 1.GUI（Graphical User Interface 图形化用户接口）

### 2.联机命令接口 (交互式命令接口)

如cmd中输入命令，输入一条命令操作系统执行一条，交互式方式

### 3.脱机命令接口（批处理命令接口）

如.bat脚本 shell脚本  让操作系统一下子执行很多命令 

### 4.程序接口(系统调用)

程序接口由一系列系统调用组成，程序接口是给编程人员使用，在编写代码的时候使用程序接口（在汇编层面本质上应该就是传参指令和陷入指令） （在高级语言层面，如c语言中，将汇编层面的指令封装成库函数，我们可以更轻松的调用）







#### 系统调用的一些知识





##### 1.系统调用是什么，其实在我理解，系统调用应该是一个过程(一个向操作系统请求共享资源处理的过程)，但通常讲的系统调用应该是系统调用程序(本质是内核程序，包含一些特权指令)，这些系统调用程序在操作系统这个软件中，在电脑启动后常驻在内存中

##### 系统调用程序向用户应用程序提供了调用他们的接口，即传参指令+陷入指令

```
因为我们在使用系统调用的时候 
1. 应用程序中使用了传参指令 和 陷入指令

2. 系统中有系统调用入口程序

3. 系统调用程序
```



##### 2.为什么需要系统调用？（什么情况下需要用到系统调用）

```
操作系统的诞生是为了提高cpu运行效率，也就是多道程序并发执行，但多道程序并发执行的时候，不可避免都会使用到系统资源（如内存，输入输出设备等），如果程序可以直接对系统资源进行操作，那么当多个程序对同一个系统资源进行操作时，就会产生错误的结果，为了让每个程序不能直接对系统资源进行操作，并且这些程序对系统资源的操作是按照一定顺序的，就产生了系统调用这个概念，操作系统提供“系统调用”功能，用户进程要使用共享资源，只能通过系统调用向操作系统发出请求。操作系统会对各个请求进行协调管理。

所以系统调用也更像是一种规范，为了让我们编写的程序能够多道程序并发执行不产生错误，我们编写的应用程序对系统资源的操作就要使用系统调用这样的方式，体现在代码上就是使用传参指令和陷入指令





应用程序通过系统调用请求操作系统的服务。而系统中的各种共享资源都由操作系统内核统一掌管，因此凡是与共享资源有关的操作(如存储分配、I/O操作、文件管理等)，都必须通过系统调用的方式向操作系统内核提出服务请求，由操作系统内核代为完成。这样可以保证系统的稳定性和安全性，防止用户进行非法操作
```

##### 3.应用程序进行系统调用的过程



![image-20210206112554178](https://raw.githubusercontent.com/yusenyi123/pictures2/master/imgs/20210206112601.png)

```
上图中，一个应用程序包含一些指令
1.当应用程序要进行系统调用时，会先执行一些传参指令，将一些参数存放到寄存器中
这些参数指明系统调用的类型

2. 在用户态执行陷入指令，引发内中断，cpu变成内核态，转入对应的中断处理程序执行（这里的中断处理程序就是系统调用入口程序）

3.系统调用入口程序检查寄存器中的参数，查找系统调用向量表，找到对应的系统调用程序

4.执行对应的系统调用程序
```

![image-20210206122015744](https://raw.githubusercontent.com/yusenyi123/pictures2/master/imgs/20210206122015.png)







###### 系统调用入口程序(本质上是一个中断处理程序，当cpu执行应用程序的陷入指令的时候，会引发内中断，然后cpu变成内核态，转向系统调用入口程序)



###### 系统调用程序(真正实现功能的程序)

















## 同步和异步的概念

### 同步的汉语意思

```
同步 [ tóng bù ] 

1.科学技术上指两个或两个以上随时间变化的量在变化过程中保持一定的相对关系。

2.泛指互相关联的事物在进行速度上协调一致：实现产值、利润和财政收入～增长。
```



### 1.在计算机网络中的同步

```
“同步通信”的通信双方必须先建立同步，即双方的时钟要调整到同一个频率。收发双方不停地发送和接收连续的同步比特流。但这时还有两种不同的同步方式。一种是使用全网同步，用一个非常精确的主时钟对全网所有结点上的时钟进行同步。另一种是使用准同步，各结点的时钟之间允许有微小的误差，然后采用其他措施实现同步传输。
```

### 2.操作系统中的同步

在操作系统中，同步指进程之间的关系，比如有两个进程，他们是同步的，就表示一个进程必须等待另外一个进程执行完成才可以执行







## 中断



### 中断概念的诞生

```
早期的计算机是单道程序运行，效率低，为了提高效率，就产生了操作系统，由操作系统实现宏观上的多到程序并发执行

为了实现多道程序并发执行，就需要一个计时器，每隔一段时间产生一个时钟信号，操作系统接收到这个信号就进行程序的调度切换(完成该功能的程序是中断处理程序中的一种)
这个信号因为中断了当前正在运行的一个程序，所有就叫中断信号，中断最初的概念也是这样来的

当然在多道程序并发执行的时候，由一个重要的问题要解决，就是多个程序对同一系统资源的时候，如果是多个程序直接对系统资源进行操作，
这时候就出现问题了，为了解决这个问题，操作系统提供“系统调用”功能，用户进程要使用共享资源，只能通过系统调用向操作系统发出请求。操作系统会对各个请求进行协调管理。
这时候将cpu的运行状态分成了内核态(管态)和用户态(目态),这两种状态的划分依靠程序状态字寄存器中的某一位来划分，
在cpu的不同状态下，可以执行的指令是不同的，用户态下只能执行非特权指令，内核态可以执行特权指令和非特权指令。

中断的概念也进行了延伸，由最初的中断当前程序运行由操作系统进行程序重新调度，变成了改变cpu运行状态，当前设定的是由操作系统重新调度程序运行必须在内核态下执行（程序运行是在用户态下运行），所以最初中断的概念变成了现在中断概念(广义中断的概念)中的一部分

原先的中断概念就是现在狭义的中断概念
```





## 联机和脱机的概念

```
早期用手工操作方式使用计算机时，操作和输入输出都是联机的(由中央处理机直接控制完成)，作业时间很长。
脱机处理技术的出现
随着计算机速度不断提高，中央处理机在输入输出操作时要等待慢速的联机输入输出设备，不能充分发挥应有的效率。为此，在批处理中引入了脱机输入输出：在主机之外另设一台小型微型机，该机只与外部设备打交道，把要处理的信息成批地输入到高速的辅助存储器（磁带或磁盘）中，再把辅助存储器与主机连接起来。主机仅从高速的辅助存储器中调入信息进行处理，作业完成后，处理结果和有关信息以文件形式存于辅助存储器中，然后再把它们转移到微型机去输出。
```



## 多道程序设计的概念

```
多道程序设计是指在允许多个作业(程序)同时进入计算机系统的内存并启动交替计算的方法。也就是说两个或两个以上程序在计算机系统中同处于开始到结束之间的状态。这就称为多道程序设计。
多道程序技术运行的特征：
1.多道、
2.宏观上并行、微观上串行。
多道程序设计的出现，加快了OS的诞生。多道程序设计的基本特征：间断性、共享性、制约性。

间断性：在并发环境下程序的执行是间断性的执行   执行---停---执行
共享性： 并发环境下程序的执行共享系统的资源
制约性：程序执行因为共享资源及相互协调的原因产生了竞争，相互制约


```

## 顺序程序设计

```
1.执行的顺序性
2.环境的封闭性
3.结果的确定性
4.过程的可再现性
```





## 中断，系统调用，特权指令，内核状态之间的关系

```
中断是一种机制，也是一种现象
中断表示当前正在运行程序暂停运行指令，将cpu交还给操作系统程序，由操作系统执行一些和系统资源相关的指令



操作系统程序系统资源的管理者，应用程序不能直接使用系统资源，需要通过操作系统程序间接使用系统资源

那么如何做到让应用程序不能直接操作系统资源呢，将指令进行划分，和系统资源相关的指令为特权指令，其余为非特权指令，将程序状态字的某一位进行作为标记，假设当为1时 可以执行特权指令即可以对系统资源进行操作，为0时不能执行特权指令，即不能操作系统资源
那么此处能够执行特权指令的cpu状态就被称为核心态（管态），不能执行特权指令的cpu状态被称为用户态(目态)

操作系统的系统调用程序是由一系列特权指令和非特权指令组成，可以完成对系统资源的操作(系统调用程序常驻内存)，操作系统向应用程序提供了调用系统调用程序的接口(本质上是传参指令+陷入指令)

执行陷入指令就可以让cpu进入核心态，而传参指令则会指明进入核心态后调用哪个系统调用程序


这种原先在执行应用程序的指令，当应用程序需要访问某些系统资源的时候，又转去运行系统调用程序，就可以看成原先的应用程序的运行被中断了，这也就是所说的内中断中的指令中断(访管中断，陷入中断)




```







